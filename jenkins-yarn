node('FreeNAS-webui-yarn') {
    stage('Checkout') {
      checkout scm
    }
    stage('yarn Install') {
      echo 'NPM Install...'
      sh 'yarn install'
    }
    stage('NPM Build') {
      echo 'yarn run build:prod:aot'
      sh 'yarn run build:prod:aot'
    }
    stage('Building UI archive') {
      sh 'rm -rf ${WORKSPACE}/artifacts'
      sh 'mkdir -p ${WORKSPACE}/artifacts'
      sh 'tar cvJf ${WORKSPACE}/artifacts/webui.txz --exclude ./artifacts .'
      archiveArtifacts artifacts: 'artifacts/**', fingerprint: true
    }
}
